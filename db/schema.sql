DROP TABLE IF EXISTS users CASCADE;
DROP TABLE IF EXISTS sensors CASCADE;
DROP TABLE IF EXISTS sensor_data CASCADE;
DROP TABLE IF EXISTS alerts CASCADE;

CREATE TABLE users (
  id SERIAL PRIMARY KEY NOT NULL,
  email VARCHAR(255) NOT NULL
);

CREATE TABLE sensors (
  id SERIAL PRIMARY KEY NOT NULL,
  url TEXT NOT NULL,
  name VARCHAR(255) NOT NULL,
  latitude FLOAT NOT NULL,
  longitude FLOAT NOT NULL,
  date DATE NOT NULL DEFAULT CURRENT_DATE,
  users_id INTEGER REFERENCES users(id) ON DELETE CASCADE,
  safe BOOLEAN NOT NULL DEFAULT true
);

CREATE TABLE sensor_data (
  id SERIAL PRIMARY KEY NOT NULL,
  sensors_id INTEGER REFERENCES sensors(id) ON DELETE CASCADE,
  date TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  co2 INTEGER NOT NULL,
  tvoc INTEGER NOT NULL,
  pm25 INTEGER NOT NULL DEFAULT -99,
  pm10 INTEGER NOT NULL DEFAULT -99
);

CREATE TABLE alerts (
  id SERIAL PRIMARY KEY NOT NULL,
  sensors_id INTEGER REFERENCES sensors(id) ON DELETE CASCADE,
  users_id INTEGER REFERENCES users(id) ON DELETE CASCADE
);